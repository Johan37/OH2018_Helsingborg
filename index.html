<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Data Driven City</title>

    <!-- CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
      integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">

    <!-- Javascript -->
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
      integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
      crossorigin=""></script>
    <script src="leaflet-heat.js"></script>
  </head>
  <body>
    <header>
        <nav class="navbar fixed-top navbar-expand-lg navbar-light">
          <a class="navbar-brand mb-0 h1" href="#">Data Driven City</a>
        </nav>
    </header> 
    <div id="mapid"></div>
    <p id="json"></p>
	<script>

		var mymap = L.map('mapid').setView([56.044, 12.71], 12);

		L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
			maxZoom: 18,
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
				'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
				'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
			id: 'mapbox.streets'
		}).addTo(mymap);

      var xmlhttp = new XMLHttpRequest();
      var url = "http://data.goteborg.se/AirQualityService/v1.0/LatestMeasurement/9309174e-34a2-4ccf-98f5-d0e33772dc7b?format=json";

      xmlhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
              var AirQuality = JSON.parse(this.responseText);
              document.getElementById("json").innerHTML = AirQuality["AirQuality"]["TotalIndex"];
              var heat = L.heatLayer([
                    [56.044, 12.71, AirQuality["AirQuality"]["TotalIndex"]*10]
                 ], {radius: 120, gradient: {0.2: 'yellow', 0.6: 'orange', 0.9: 'red'}}).addTo(mymap);
          }
      };
      xmlhttp.open("GET", url, true);
      xmlhttp.send();
	</script>
  </body>
</html>

